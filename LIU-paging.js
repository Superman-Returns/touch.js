// liu tong biao 
// 2019-10-27
function pagingfn(setobj,fn){let paginghtml='';paginghtml+=' <div class="paging LIU-PAGES">';paginghtml+='<div class="control">';paginghtml+='<div class="text" style=" border-right: 1px solid #ccc;">共计<span class="allinfolist"></span>条</div>';paginghtml+='<div class="onepage" style=" border-right: 1px solid #ccc;">首页</div>';paginghtml+='<div class="prepage" style=" border-right: 1px solid #ccc;">上一页</div>';paginghtml+='<div class="pages"><ul></ul></div>';paginghtml+='<div class="nextpage" style=" border-right: 1px solid #ccc;">下一页</div>';paginghtml+='<div class="lastpage">尾页</div></div>';paginghtml+='<div class="select">';paginghtml+='<select class="eachpage">';paginghtml+=' <option value="1">1条/页 </option>';paginghtml+=' <option value="2">2条/页 </option>';paginghtml+=' <option value="3">3条/页 </option>';paginghtml+=' <option value="4">4条/页 </option>';paginghtml+=' <option value="5">5条/页 </option>';paginghtml+=' <option value="6">6条/页 </option>';paginghtml+=' <option value="7">7条/页 </option>';paginghtml+=' <option value="8">8条/页 </option>';paginghtml+=' <option value="9">9条/页 </option>';paginghtml+='<option value="10" selected>10条/页 </option>';paginghtml+=' <option value="20">20条/页 </option>';paginghtml+='<option value="30">30条/页 </option>';paginghtml+=' <option value="40" >40条/页 </option>';paginghtml+='<option value="50">50条/页 </option>';paginghtml+='<option value="60">60条/页 </option>';paginghtml+='</select></div><div class="changepage">';paginghtml+='<p> <span>到第</span> <input type="text" value="1"><span>页</span></p>';paginghtml+='<button class="jumppages">确定</button>';paginghtml+='</div>';paginghtml+='</div>';var $el=setobj.$el?$(setobj.$el):alert('您还没有绑定dom');var msgarr=setobj.msgarr?setobj.msgarr:alert('您绑定的数组有误');var select=setobj.select?setobj.select:false;var choosepage=setobj.choosepage?setobj.choosepage:false;var pageallnum=setobj.selected?setobj.selected:10;$el.html(paginghtml);if(!select){$el.find(".select").hide()};if(!choosepage){$el.find(".changepage").hide()}$el.find(".select option").eq(pageallnum-1).attr('selected','true').siblings().removeAttr('selected');var numindex=0;setwidthfn();function setwidthfn(){let html='';for(let i=0;i<msgarr.length/pageallnum;i++){html+='<li>'+(i+1)+'</li>'}$el.find(".pages>ul").html(html);$el.find(".allinfolist").html(msgarr.length);if(Math.ceil(msgarr.length/pageallnum)==1){$el.find(".paging .pages").width(59)}else if(Math.ceil(msgarr.length/pageallnum)==2){$el.find(".paging .pages").width(119)}else{$el.find(".paging .pages").width(179)}$el.find(".paging").width($el.find(".paging .control").width()+$el.find(".paging .select").width()+$el.find(".paging .changepage").width()+50)}pagebgcfn(numindex);function pagebgcfn(num){$el.find(".paging .pages>ul").children().eq(num).addClass('active').siblings().removeClass('active');let left=-num*60<-(Math.ceil(msgarr.length/pageallnum)-2)*60?-(Math.ceil(msgarr.length/pageallnum)-2)*60:-num*60;left=left+60>0?0:left+60;$el.find(".paging .pages>ul").css({left:left})}$el.find(".nextpage").click(function(){numindex++;numindex=numindex>=Math.ceil(msgarr.length/pageallnum)?0:numindex;pagebgcfn(numindex);getinfofn(numindex)});$el.find(".prepage").click(function(){numindex--;numindex=numindex<0?Math.ceil(msgarr.length/pageallnum)-1:numindex;pagebgcfn(numindex);getinfofn(numindex)});$el.find(".onepage").click(function(){numindex=0;pagebgcfn(numindex);getinfofn(numindex)});$el.find(".lastpage").click(function(){numindex=Math.ceil(msgarr.length/pageallnum)-1;pagebgcfn(numindex);getinfofn(numindex)});$el.find(".pages>ul").on('click','li',function(e){numindex=$el.find(e.target).index();pagebgcfn(numindex);getinfofn(numindex)});$el.find('.jumppages').click(function(){numindex=$el.find(".changepage p input").val()-1;numindex=numindex>=Math.ceil(msgarr.length/pageallnum)?Math.ceil(msgarr.length/pageallnum)-1:numindex;if(numindex>=0&&numindex<9999&&numindex%1==0){pagebgcfn(numindex);getinfofn(numindex)}});$el.find('.paging .select .eachpage').change(function(){pageallnum=$el.find('.paging .select .eachpage').val()-0;numindex=0;setwidthfn();pagebgcfn(0);getinfofn(0)});function getinfofn(num){num=num>=Math.ceil(msgarr.length/pageallnum)?0:num;num=num<0?Math.ceil(msgarr.length/pageallnum)-1:num;let thisarr=msgarr.slice(num*pageallnum,(num+1)*pageallnum);fn(thisarr)}}
